<div class="panel panel-default outer-panel panel-info">
  <!-- Default panel contents -->
  <div class="panel-heading"><h3 class="panel-title">Campaign Detail</h3></div>
  <div class="panel-body">
    <dl class="dl-horizontal">
      <dt>Name</dt>
      <dd><%= @campaign.name %></dd>
      <dt>Deadline</dt>
      <dd><%= @campaign.deadline %></dd>
      <dt>Ready for Donations</dt>
      <dd><input type=checkbox disabled <%= @campaign.ready_for_donations ? 'checked' : '' %> /></dd>
      <dt>Address</dt>
      <dd><address><%= h(@campaign.address).gsub(/\n/, '<br/>').html_safe %></address></dd>
    </dl>
  </div>

  <div class="panel panel-default table-condensed">
    <!-- Default panel contents -->
    <div class="panel-heading"><h3 class="panel-title">Wishlists</h3></div>
    <table class="table table-striped table-condensed">
      <caption>
        <%= form_tag(url_for([:readers, get_namespace, @campaign.organization, @campaign]), method: :get, remote: true, :class => 'form-inline') do %>
          <div class="form-group">
            <%= link_to '<i class="glyphicon glyphicon-plus"></i> New Wishlist'.html_safe, url_for([:new, get_namespace, @campaign.organization, @campaign, :wishlist]), :class => "btn btn-xs btn-primary" %>
          </div>
          <div class="input-group">
            <input class="form-control" name="term" id="term" placeholder="Name or teacher" />
            <span class="input-group-btn">
              <button class="btn btn-primary" type="submit">Search</button>
            </span>
          </div>
          <div class="form-group">
            <p class="form-control-static">Enter part of the reader's name or teacher's name or leave blank to return all.</p>
          </div>
        <% end -%>

      </caption>
      <thead>
        <tr>
          <th>Teacher</th>
          <th>Name</th>
          <th>Age</th>
          <th>Gender</th>
          <th>Book Count</th>
          <% if admin? %>
          <th>Wishlist Total</th>
          <th>Donation Total</th>
          <% end %>
          <th>&nbsp;</th>
        </tr>
      </thead>
      <tfoot>
        <tr>
          <th colspan="4"></th>
          <th><%= WishlistEntry.where(:wishlist_id => @campaign.wishlists).count %></th>
          <% if admin? %>
          <th><%= number_to_currency(CatalogEntry.joins(:wishlist_entries => :wishlist).where('wishlist_entries.wishlist_id' => @campaign.wishlists).sum(:price)) %></th>
          <th><%= number_to_currency(Donation.where(:wishlist_id => @campaign.wishlists).sum(:amount)) %></th>
          <% end %>
          <th>&nbsp;</th>
        </tr>
      </tfoot>
      <tbody id="reader_list">
      <%#= render :partial => 'common/campaigns/wishlist', :collection => @campaign.wishlists.order([:teacher, :reader_name]) %>
      </tbody>
    </table>
  </div>

</div>
